<div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-11-28T16:00:00.000Z" title="2021/11/29 上午12:00:00">2021-11-29</time>发表</span><span class="level-item"><time dateTime="2021-12-12T03:14:58.000Z" title="2021/12/12 上午11:14:58">2021-12-12</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6/">拥塞控制</a><span> / </span><a class="link-muted" href="/categories/%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6/%E5%B9%BF%E5%9F%9F%E7%BD%91/">广域网</a></span><span class="level-item">10 分钟读完 (大约1558个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">终端主机的AQM</h1><div class="content"><!--toc-->



<p><img src="/2021/11/29/11.29%E7%BB%88%E7%AB%AF%E4%B8%BB%E6%9C%BA%E7%9A%84AQM/image-20211129085259887.png" alt="image-20211129085259887"></p>
<p><img src="/2021/11/29/11.29%E7%BB%88%E7%AB%AF%E4%B8%BB%E6%9C%BA%E7%9A%84AQM/image-20211129085332802.png" alt="image-20211129085332802"></p>
<span id="more"></span>

<h2><span id="背景">背景</span></h2><p>主动队列管理（AQM）领域：</p>
<ul>
<li><p>一个学派认为，瓶颈链路上的路由器知道缓冲区何时满了，因此处于判断拥塞开始的最佳位置。一旦检测到拥塞，它们通过二进制信号（例如，[2,14,16,19,25]）或非二进制信号（例如，[18,32]）隐式地通知终端主机，该信号通知发送方其发送速率应该是多少。</p>
</li>
<li><p>第二种学派讲网络视为黑匣子，试图从终端主机检测网络拥塞。在这些方案中，发送方试图根据往返时间或观察到的吞吐量中包含的信息来确定网络中的拥塞水平，并对其作出响应，以防止数据包丢失。在这种方法中，发送方不期望路由器提供任何支持将这方面的工作称为基于终端主机延迟的拥塞避免。</p>
</li>
</ul>
<p>虽然路由器确实处于检测网络拥塞的最佳位置，但在核心路由器中部署实验性AQM机制并不容易。</p>
<p><strong>但基于终端主机延迟的方案受到了对终端主机拥塞预测准确性和有效性的质疑。</strong></p>
<p>通过在终端主机的拥塞响应函数中模拟基于路由器的AQM方案的概率标记机制，可以获得类似于基于路由器的AQM的性能和效益，而不需要对路由器进行任何修改</p>
<p><strong>基于终端主机的拥塞预测的相关工作</strong></p>
<ul>
<li><p>在TRI-S[29]中，作者建议使用归一化吞吐量梯度而不是归一化延迟梯度来预测瓶颈链路何时达到饱和。</p>
</li>
<li><p>在DUAL[30]中，作者将RTT的当前样本与最小和最大RTT的平均值进行比较，以确定瓶颈链路队列是否已满了一半，是否需要响应。</p>
</li>
<li><p>在Vegas[7]中，作者建议将实现的吞吐量与基于最小观测RTT的预期吞吐量进行比较，以预测拥塞。</p>
</li>
<li><p>在CIM[21]中，作者建议将少量RTT样本的移动平均值与大量RTT样本的移动平均值进行比较，以确定是否存在拥塞。</p>
</li>
<li><p>在TCP-BFA[3]中，作者建议监控RTT的变化，以防止瓶颈链路填满。</p>
</li>
<li><p>在Sync-TCP[31]中，作者使用单向延迟趋势结合四种不同级别的窗口增加/减少来改进基于延迟的拥塞避免</p>
<p><img src="/2021/11/29/11.29%E7%BB%88%E7%AB%AF%E4%B8%BB%E6%9C%BA%E7%9A%84AQM/image-20211130153259460.png" alt="image-20211130153259460"></p>
</li>
</ul>
<p><img src="/2021/11/29/11.29%E7%BB%88%E7%AB%AF%E4%B8%BB%E6%9C%BA%E7%9A%84AQM/image-20211129144907646.png" alt="image-20211129144907646"></p>
<p>状态A表示“低延迟”或“低拥塞”状态。当观察到更高的延迟或瓶颈队列开始被填满时，流从状态A转换为状态B。如果未采取任何操作，则流将转换为状态C或“数据包丢失”状态。作为对数据包丢失的响应，当流减少其拥塞窗口时，瓶颈队列开始清空，流最终将返回到状态A。</p>
<p>过渡“4”（状态A到C）可能意味着发生了短期拥塞，并且流无法预测它，因此无法避免由此产生的损失，或者协议在预测拥塞方面不够积极。这种转变表明存在“假阴性”（false negatives）。</p>
<p>另一方面，我们称之为“假阳性”（false positive）的转换“5”（状态B到A）将意味着协议在预测拥塞时过于激进或不可靠，因此可能会不必要地降低其发送速率并面临性能下降。</p>
<h2><span id="设计机制">设计机制</span></h2><p><u>RED协议栈的路由器中，通过监测平均队列长度来推断拥塞，同时通过允许瞬时队列长度的波动来适应突发流量。</u></p>
<p>概率早期响应TCP（PERT）解决假阳性，当假阳性概率较高时，对早期拥塞信号的响应概率应较低，反之亦然。</p>
<p>设置两个阈值Tmin和Tmax,以及响应的最大概率Pmax。如果srtt0.99的值小于Tmin，响应概率就为0.当srtt0.99增长到超过Tmin，响应于每个ACK而减小窗口的概率线性增加。</p>
<p>当srtt0.99介于Tmax和2Tmax之间，概率从Pmax变为1，超过Pmax,概率保持不变为1。</p>
<p>对于参数Tmin、Tmax和Pmax，分别使用固定值（p+5ms、p+10ms和0.05），p是从流中基于最小RTT观察到的传播延迟。</p>
<p>PERT模型由三部分组成：窗口调整、RED仿真和排队延迟计算</p>
<p><strong>窗口调整</strong>：R（t）表示终端用户在时间t测量的往返时间，传播延迟Tp和排队延迟Tq</p>
<p><img src="/2021/11/29/11.29%E7%BB%88%E7%AB%AF%E4%B8%BB%E6%9C%BA%E7%9A%84AQM/image-20211130165053297.png" alt="image-20211130165053297"></p>
<p>用C表示链路的容量，用q（t）表示t时刻的队列大小，排队延迟Tq（t）可以近似为q（t−R（t））/C</p>
<p><img src="/2021/11/29/11.29%E7%BB%88%E7%AB%AF%E4%B8%BB%E6%9C%BA%E7%9A%84AQM/image-20211130165109613.png" alt="image-20211130165109613"></p>
<p>p(t)为数据包丢失概率：</p>
<p><img src="/2021/11/29/11.29%E7%BB%88%E7%AB%AF%E4%B8%BB%E6%9C%BA%E7%9A%84AQM/image-20211130165131644.png" alt="image-20211130165131644"></p>
<p><strong>RED仿真</strong>的一个组成部分是对往返时间R（t）的估计，该时间R（t）使用权重为α的低通滤波器（LPF）对每个分组进行更新：</p>
<p><img src="/2021/11/29/11.29%E7%BB%88%E7%AB%AF%E4%B8%BB%E6%9C%BA%E7%9A%84AQM/image-20211130165148605.png" alt="image-20211130165148605"></p>
<p>根据LPF的微分方程进行描述：</p>
<p><img src="/2021/11/29/11.29%E7%BB%88%E7%AB%AF%E4%B8%BB%E6%9C%BA%E7%9A%84AQM/image-20211130165203830.png" alt="image-20211130165203830"></p>
<p><img src="/2021/11/29/11.29%E7%BB%88%E7%AB%AF%E4%B8%BB%E6%9C%BA%E7%9A%84AQM/image-20211130165220546.png" alt="image-20211130165220546"></p>
<p><strong>计算排队延迟</strong>：</p>
<p><img src="/2021/11/29/11.29%E7%BB%88%E7%AB%AF%E4%B8%BB%E6%9C%BA%E7%9A%84AQM/image-20211130165235481.png" alt="image-20211130165235481"></p>
<h3><span id="核心思想">核心思想</span></h3><p>通过在终端主机的拥塞响应函数中模拟基于路由器的AQM方案的概率标记机制，可以获得类似于基于路由器的AQM的性能和效益，而不需要对路由器进行任何修改。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>终端主机的AQM</p><p><a href="http://example.com/2021/11/29/11.29终端主机的AQM/">http://example.com/2021/11/29/11.29终端主机的AQM/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>周 升温</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-11-29</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-12-12</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6/">拥塞控制</a><a class="link-muted mr-2" rel="tag" href="/tags/%E9%98%9F%E5%88%97%E9%95%BF%E5%BA%A6/">队列长度</a><a class="link-muted mr-2" rel="tag" href="/tags/%E6%A6%82%E7%8E%87%E5%93%8D%E5%BA%94/">概率响应</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/11/29/11.29+7%E5%90%8C%E6%AD%A5TCP/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">同步TCP</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/11/23/11.23MATCP/"><span class="level-item">MATCP</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="SOHUCS" sid="2021/11/29/11.29终端主机的AQM/"></div><script charset="utf-8" src="https://changyan.sohu.com/upload/changyan.js"></script><script>window.changyan.api.config({appid: 'cyvNTrKXF',conf: 'prod_beafff693eade74de3a3de7ec158cb96'});</script></div></div>